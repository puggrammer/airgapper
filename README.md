<a name="readme-top"></a>

<!-- [![Contributors][contributors-shield]][contributors-url]
[![Forks][forks-shield]][forks-url] -->
[![Stargazers][stars-shield]][stars-url]
[![Issues][issues-shield]][issues-url]
[![MIT License][license-shield]][license-url]


<!-- PROJECT LOGO -->
<br />
<div align="center">
  <a href="https://github.com/othneildrew/Best-README-Template">
    <img src="images/logo.png" alt="Logo" width="80" height="80">
  </a>

  <h3 align="center">Airgapper</h3>

  <p align="center">
    Taking the shet pain out of air-gapped environments.
    <br />
    <a href="https://github.com/othneildrew/Best-README-Template"><strong>Explore the docs Â»</strong></a>
    <br />
    <br />
    <a href="https://github.com/othneildrew/Best-README-Template">View Demo</a>
    Â·
    <a href="https://github.com/othneildrew/Best-README-Template/issues/new?labels=bug&template=bug-report---.md">Report Bug</a>
    Â·
    <a href="https://github.com/othneildrew/Best-README-Template/issues/new?labels=enhancement&template=feature-request---.md">Request Feature</a>
  </p>
</div>


<!-- TABLE OF CONTENTS -->
<details>
  <summary>Table of Contents</summary>
  <ol>
    <li>
      <a href="#about-the-project">About The Project</a>
      <ul>
        <li><a href="#built-with">Built With</a></li>
      </ul>
    </li>
    <li>
      <a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#installation">Installation</a></li>
      </ul>
    </li>
    <li><a href="#usage">Usage</a></li>
    <li><a href="#roadmap">Roadmap</a></li>
    <li><a href="#contributing">Contributing</a></li>
    <li><a href="#license">License</a></li>
    <li><a href="#contact">Contact</a></li>
    <li><a href="#acknowledgments">Acknowledgments</a></li>
  </ol>
</details>


<!-- ABOUT THE PROJECT -->
## About Airgapper

[![Product Name Screen Shot][product-screenshot]](https://example.com)

Taking the shet pain out of airgapped environment.


<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Feature Matrix

<table class="tg" align=center>
  <thead>
  <tr>
    <th class="tg-repo">Packages<br>/<br>Hosted Repositories</th>
    <th class="tg-repo" align=center>
      <span>Nexus</span><br>
      <img height="48px" src="https://www.sonatype.com/hubfs/2019%20Product%20logo/Product%20Logo%20SVGs/NexusRepo_Vertical.svg">
    </th>
    <th class="tg-repo" align=center>
      <span>Harbor</span><br>
      <img height="48px" src="https://landscape.cncf.io/logos/de4f2dfd628db72e7d482ff0d9d22f0615f800a222ce7c8d6d2b5a147da77883.svg">
    </th>
  </tr></thead>
<tbody>
  <tr>
    <td class="tg-package" align=center>
      <span>Python Package (pypi)</span><br>
      <img height="32px" src="https://cdn.svgporn.com/logos/python.svg">
    </td>
    <td class="tg-normal" align=center>
      <img class="tick-icon" src="https://cdn-icons-png.flaticon.com/512/2550/2550322.png" height=32px width=32px >
    </td>
    <td class="tg-NA" align=center>
      <img class="cross-icon" src="https://cdn-icons-png.flaticon.com/512/3389/3389149.png" height=32px width=32px >
    </td> 
    <!-- &#x274C;< -->
      <!-- <img height="64px" src="https://cdn3.iconfinder.com/data/icons/meteocons/512/n-a-512.png"> -->
  </tr>
  <tr>
    <td class="tg-package" align=center>
      <span>Maven Java Packages</span><br> 
      <img height="32px" src="https://cdn.svgporn.com/logos/maven.svg">
    </td>
    <td class="tg-normal" align=center>
      <img class="tick-icon" src="https://cdn-icons-png.flaticon.com/512/2550/2550322.png" height=32px width=32px >
    </td>
    <td class="tg-NA" align=center>
      <img class="cross-icon" src="https://cdn-icons-png.flaticon.com/512/3389/3389149.png" height=32px width=32px >
    </td> 
  </tr>
  <tr>
    <td class="tg-package" align=center>
      <span>Docker Image</span><br>
      <img height="32px" src="https://cdn.svgporn.com/logos/docker-icon.svg">
    </td>
    <td class="tg-normal" align=center>
      <img class="tick-icon" src="https://cdn-icons-png.flaticon.com/512/2550/2550322.png" height=32px width=32px >
    </td>
    <td class="tg-normal" align=center>
      <img class="tick-icon" src="https://cdn-icons-png.flaticon.com/512/2550/2550322.png" height=32px width=32px >
    </td>
  </tr>
  <tr>
    <td class="tg-package" align=center>
      <span>Helm Chart</span><br>
      <img height="32px" src="https://cdn.svgporn.com/logos/helm.svg">
    </td>
    <td class="tg-normal" align=center>
      <img class="wip-icon" src="https://cdn-icons-png.flaticon.com/512/10295/10295925.png" height=32px width=32px>    
    </td>
    <td class="tg-normal" align=center>
      <img class="wip-icon" src="https://cdn-icons-png.flaticon.com/512/10295/10295925.png" height=32px width=32px>    
    </td>
  </tr>
  <tr>
    <td class="tg-package" align=center>
      <span>Bitnami Helm Charts</span><br>
      <img height="32px" src="https://cdn.svgporn.com/logos/bitnami.svg">
    </td>
    <td class="tg-normal" align=center>
      <img class="wip-icon" src="https://cdn-icons-png.flaticon.com/512/10295/10295925.png" height=32px width=32px>    
    </td>
    <td class="tg-normal" align=center>
      <img class="tick-icon" src="https://cdn-icons-png.flaticon.com/512/2550/2550322.png" height=32px width=32px >
    </td>
  </tr>
</tbody>
</table>



<!-- GETTING STARTED -->
## Getting Started

Just download package from pypi repository. Its that easy!
  ```sh
  pip install airgapper
  ```

The package will use existing tools (docker, mvn etc.) to automate the downloading and uploading of library packages.

### Prerequisites

The following are the prerequisites when working with different libraries

#### Python
- Python 3.7+
- [Requests Library](https://pypi.org/project/requests/)

#### Docker
- [Docker Engine](https://docs.docker.com/engine/)

#### Bitnami Helm
- [Docker Engine](https://docs.docker.com/engine/)
- [Bitnami Helm Distribution Tool](https://github.com/vmware-labs/distribution-tooling-for-helm) 

### Installation

_Below is an example of how you can instruct your audience on installing and setting up your app. This template doesn't rely on any external dependencies or services._

1. Get a free API Key at [https://example.com](https://example.com)
2. Clone the repo
   ```sh
   git clone https://github.com/your_username_/Project-Name.git
   ```
3. Install NPM packages
   ```sh
   npm install
   ```
4. Enter your API in `config.js`
   ```js
   const API_KEY = 'ENTER YOUR API';
   ```

<p align="right">(<a href="#readme-top">back to top</a>)</p>



<!-- USAGE EXAMPLES -->
## Usage

Use this space to show useful examples of how a project can be used. Additional screenshots, code examples and demos work well in this space. You may also link to more resources.

### ðŸ”§ Environment Variables

Environment variables allow you to configure the behavior of the application without modifying the source code. This makes it easier to manage different environments (development, staging, production) and keep sensitive information out of version control.

#### ðŸ“¦ Global Common Variables

| Variable Name             | Description                                                                 | Default Value              |
|---------------------------|-----------------------------------------------------------------------------|----------------------------|
| `TMP`                 | Specifies the runtime environment                                           | `development`, `production`|
| `AIRGAPPER_INSECURE`      | Set to `true` to disable TLS verification for registry connections.         | `false` |

#### Helm Parameters
| Variable Name             | Description                                                                 | Value              |
|----------------------|----------------------------------------------------------------------------------|----------------------------|
| `AIRGAPPER_DT_DIRECTORY`    | directory containing dt binary.                                           | "" |

#### Harbor Registry Par
| Variable Name             | Description                                                                 | Value                      |
|---------------------------|-----------------------------------------------------------------------------|----------------------------|
| `AIRGAPPER_HARBOR_URL`    | Base URL of the Harbor container registry                                   | 127.0.1.1:8090             |
| `AIRGAPPER_HARBOR_USER`   | Harbor username                                                             | admin                      |
| `AIRGAPPER_HARBOR_PASS`   | Harbor password                                                             | Harbor12345                |
| `AIRGAPPER_HARBOR_PROJECT`| Harbor project namespace to upload image                                    | library                    |

#### Nexus Registry Par
| Variable Name                 | Description                                                                 | Value                   |
|-------------------------------|-----------------------------------------------------------------------------|-------------------------|
| `AIRGAPPER_NEXUS_URL`         | Base URL of Nexus registry                                                  | http://127.0.0.1:8091   |
| `AIRGAPPER_NEXUS_DOCKER_URL`  | Docker-specific URL of Nexus registry                                       | "127.0.0.1:8092"        |
| `AIRGAPPER_NEXUS_USER`        | Nexus username                                                              | admin                   |
| `AIRGAPPER_NEXUS_PASS`        | Nexus password                                                              | nexus                   |


### Maven

#### Download
1. Search for maven/gradle plugin package at [Maven Repository](https://mvnrepository.com)
2. Select version and copy xml snippet into pom.xml
    <details><summary>pom.xml example</summary>
        ```xml
        pom.xml

        <project>
            <modelVersion>4.0.0</modelVersion>
            <groupId>com.example</groupId>
            <artifactId>sample-project</artifactId>
            <version>1.0-SNAPSHOT</version>
            <name>Sample Project</name>

            <dependencies>
                <!-- Gson Library for JSON processing -->
                <dependency>
                    <groupId>com.google.code.gson</groupId>
                    <artifactId>gson</artifactId>
                    <version>2.8.9</version>
                </dependency>
            </dependencies>
        </project>
        ```
    </details>

3. Download
    ```sh
    airgapper maven download pom.xml -o ./output-directory
    ```
#### Upload
1. Inject required environment variables.
2. Upload
    ```sh
    airgapper maven upload ./output-directory \
        "-a",
        "nexus", # Application
        "-r",
        "http://nexus.local.arpa:8080", # Application URL 
        "--repo",
        "maven-hosted", # Repository Name
    ```

_For more examples, please refer to the [Documentation](https://example.com)_

<p align="right">(<a href="#readme-top">back to top</a>)</p>


###

## Manual Helm Chart 
how to install from a traditional helm repository?
<!-- 1. helm repo add grafana https://grafana.github.io/helm-charts -->
2. Pull helm chart to local directory
```bash
helm pull my-tempo-distributed --repo https://grafana.github.io/helm-charts/grafana/tempo-distributed --version 1.48.0 --untar
helm dependency update
```
3. Create the image annotations section in Chart.yml, as shown in `https://github.com/vmware-labs/distribution-tooling-for-helm`<br>
run `dt charts annotate ./` first
```yaml
# Sample Chart.yml from bitnami's helm chart
annotations:
  images: |
    - name: grafana-tempo
      image: docker.io/bitnami/grafana-tempo:2.8.2-debian-12-r1
    - name: grafana-tempo-query
      image: docker.io/bitnami/grafana-tempo-query:2.8.2-debian-12-r1
    - name: grafana-tempo-vulture
      image: docker.io/bitnami/grafana-tempo-vulture:2.8.2-debian-12-r1
    - name: os-shell
      image: docker.io/bitnami/os-shell:12-debian-12-r50
  licenses: Apache-2.0
  tanzuCategory: application
apiVersion: v2
appVersion: 2.8.2
description: Grafana Tempo is a distributed tracing system that has out-of-the-box
  integration with Grafana. It is highly scalable and works with many popular tracing
  protocols.
version: 5.0.1
```
4. Extract all the docker images (search for term `repository:`) and their tags in values.yml.
```yaml
# Sample values.yaml from grafana tempo-distributed official helm chart

.
.
# Configuration for the query-frontend
queryFrontend:
  query:
    # -- Required for grafana version <7.5 for compatibility with jaeger-ui. Doesn't work on ARM arch
    enabled: false
    image:
      # -- The Docker registry for the tempo-query image. Overrides `tempo.image.registry`
      registry: null
      # -- Optional list of imagePullSecrets. Overrides `tempo.image.pullSecrets`
      pullSecrets: []
      # -- Docker image repository for the tempo-query image. Overrides `tempo.image.repository`
      repository: grafana/tempo-query
      # -- Docker image tag for the tempo-query image. Overrides `tempo.image.tag`
      tag: null
```
5. If tag is null, tag is likely the same tag as the `appVersion` in Chart.yaml.<br>
Search & verify the tag. Eg. `https://hub.docker.com/r/grafana/tempo-query/tags?name=2.8.2`
6. Extract all the docker images (search for term `image:`) and their tags in used in */templates/
7. `dt wrap ./`


<!-- ROADMAP -->
## Roadmap

- [ ] Add Maven support
  - [ ] Add gradle plugins support
- [ ] Add generic Helm chart support
  - [ ] Handle recursive subdependencies

See the [open issues](https://github.com/othneildrew/Best-README-Template/issues) for a full list of proposed features (and known issues).


<!-- LICENSE -->
## License
Distributed under the MIT License. See `LICENSE.txt` for more information.
<p align="right">(<a href="#readme-top">back to top</a>)</p>


<!-- MARKDOWN LINKS & IMAGES -->
<!-- https://www.markdownguide.org/basic-syntax/#reference-style-links -->
[contributors-shield]: https://img.shields.io/github/contributors/puggrammer/airgapper.svg?style=for-the-badge
[contributors-url]: https://github.com/puggrammer/airgapper/graphs/contributors
[forks-shield]: https://img.shields.io/github/forks/puggrammer/airgapper.svg?style=for-the-badge
[forks-url]: https://github.com/puggrammer/airgapper/network/members
[stars-shield]: https://img.shields.io/github/stars/puggrammer/airgapper.svg?style=for-the-badge
[stars-url]: https://github.com/puggrammer/airgapper/stargazers
[issues-shield]: https://img.shields.io/github/issues/puggrammer/airgapper.svg?style=for-the-badge
[issues-url]: https://github.com/puggrammer/airgapper/issues
[license-shield]: https://img.shields.io/github/license/puggrammer/airgapper.svg?style=for-the-badge
[license-url]: https://github.com/puggrammer/airgapper/blob/master/LICENSE.txt
<!-- [linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=for-the-badge&logo=linkedin&colorB=555
[linkedin-url]: https://linkedin.com/in/othneildrew -->
[product-screenshot]: images/screenshot.png
